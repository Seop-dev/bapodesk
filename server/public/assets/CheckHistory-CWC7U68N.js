import{_ as b,a as y}from"./UiParentCard.vue_vue_type_script_setup_true_lang-BW8k9qJX.js";import{B as N}from"./main-CfRLyuEJ.js";import{aZ as v,a_ as w,O as n,_ as E,y as T,P as A,q as S,o as $,a as s,w as c,V as D,b as M,a0 as I,A as f,a1 as F,F as V,$ as P}from"./index-BkOgXO0r.js";const R="http://localhost:3000",L={__name:"CheckHistory",setup(k){v.registerModules([w]);const m=F,p=n([{field:"설비코드",flex:1},{field:"설비명",flex:1},{field:"설비유형",flex:1},{field:"점검내역",flex:1},{field:"점검시작일",flex:1.5},{field:"점검완료일",flex:1.5},{field:"다음점검일",flex:1},{field:"적합여부",flex:1,cellStyle:t=>t.value==="적합"?{color:"blue",fontWeight:"bold"}:t.value==="부적합"?{color:"red",fontWeight:"bold"}:null},{field:"부적합사유",flex:1.5},{field:"담당자",flex:1}]),_={editable:!1,sortable:!0,resizable:!0,suppressMenu:!0},i=n(""),o=n([]);function u(t,a=!0){if(!t)return"";const e=new Date(t);if(Number.isNaN(e.getTime())){const r=String(t);return a?r.slice(0,19).replace("T"," "):r.slice(0,10)}const l=r=>String(r).padStart(2,"0"),d=`${e.getFullYear()}-${l(e.getMonth()+1)}-${l(e.getDate())}`;if(!a)return d;const C=`${l(e.getHours())}:${l(e.getMinutes())}:${l(e.getSeconds())}`;return`${d} ${C}`}E(async()=>{try{const{data:t}=await P.get(`${R}/facility/inspections/history`),a=Array.isArray(t)?t:[];o.value=a.map(e=>({설비코드:e.FAC_ID??"",설비명:e.FAC_NAME??"",설비유형:e.FAC_TYPE_NM??e.FAC_TYPE??"",점검내역:e.INSPECT_CONTENT??"",점검시작일:u(e.INSPECT_START,!0),점검완료일:u(e.INSPECT_DONE,!0),다음점검일:u(e.NEXT_INSPECT,!1),적합여부:e.FIT??"",부적합사유:e.NG_REASON??"",담당자:e.MANAGER??""}))}catch(t){console.error("점검 이력 조회 실패:",t),o.value=[]}});const g=T(()=>{const t=(i.value||"").trim().toLowerCase();return t?o.value.filter(a=>{const e=String(a.설비코드||"").toLowerCase(),l=String(a.설비명||"").toLowerCase();return e.includes(t)||l.includes(t)}):o.value}),h=n({title:"설비 점검 관리"}),x=A([{title:"설비",disabled:!0,href:"#"},{title:"점검 내역",disabled:!1,href:"#"}]);return(t,a)=>($(),S(V,null,[s(b,{title:h.value.title,breadcrumbs:x.value},null,8,["title","breadcrumbs"]),s(y,{title:"점검 내역"},{default:c(()=>[s(D,{align:"center",class:"mb-3"},{default:c(()=>[s(M,{cols:"12",md:"6",class:"d-flex justify-start"},{default:c(()=>[s(I,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),modelModifiers:{trim:!0},placeholder:"설비선택 (설비코드/설비명 입력)","hide-details":"",density:"compact",variant:"outlined",style:{"max-width":"280px"}},null,8,["modelValue"])]),_:1})]),_:1}),s(f(N),{class:"ag-theme-quartz grid-clean",style:{height:"420px"},theme:f(m),rowData:g.value,columnDefs:p.value,defaultColDef:_,animateRows:!0,pagination:!0,"pagination-page-size":10,suppressClickEdit:!0},null,8,["theme","rowData","columnDefs"])]),_:1})],64))}};export{L as default};
