import{_ as ee,a as oe}from"./UiParentCard.vue_vue_type_script_setup_true_lang-BW8k9qJX.js";import{O as s,P as te,_ as le,$ as u,q as ae,o as re,a as l,w as n,d as i,a0 as m,f,e as p,A as M,a1 as se,V as R,b as g,F as ne}from"./index-BkOgXO0r.js";import{B as y}from"./main-CfRLyuEJ.js";import{_ as ie}from"./NewModal-C5NqQFOW.js";import{d as de}from"./index-BqhsvV9-.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"d-flex align-center mb-4"},me={class:"main-container"},fe={class:"list-container"},pe={class:"d-flex align-center mb-2"},Me={class:"form-wrapper"},ve={class:"add"},De={class:"btn-list"},he={__name:"MasterBom",setup(be){const C=se,P=new Date().toISOString().split("T")[0],a=s({writer:"",addDate:P,bomVer:"",bomCode:"",prdName:""}),r=de.useToast(),v=s([]),S=s([{field:"제품명",flex:1},{field:"제품코드",flex:1},{field:"제품유형",flex:1},{field:"작성자",flex:1},{field:"등록일",flex:1}]),D=s([]),k=s([{field:"BOM코드",editable:!0,flex:1},{field:"제품명",flex:1},{field:"BOM버젼",flex:1},{field:"작성자",flex:1},{field:"사용유무",flex:1},{field:"등록일",flex:1}]),h=s([]),I=s([{headerCheckboxSelection:!0,checkboxSelection:!0,width:50},{field:"자재코드",editable:!0,flex:1},{field:"자재명",flex:1},{field:"자재유형",flex:1},{field:"소요수량",flex:1,editable:!0,cellEditor:"agNumberCellEditor",cellEditorParams:{inputType:"number",min:0,step:1}},{field:"단위",flex:1,editable:!0}]),U=s({title:"BOM관리"}),Y=te([{title:"기준정보",disabled:!0,href:"#"},{title:"BOM 관리",disabled:!1,href:"#"}]),F=async()=>{try{const t=await u.get("http://localhost:3000/BOMprdSelect");v.value=t.data.map(e=>({제품명:e.PRD_NAME,제품코드:e.PRD_CODE,제품유형:e.PRD_TYPE,작성자:e.PRD_WRITER,등록일:e.PRD_DATE.substring(0,10)}))}catch(t){console.error("제품 목록을 불러오는 중 오류가 발생했습니다:",t),r.error("제품 목록을 불러올 수 없습니다.",{position:"top-right",duration:1e3})}},b=async()=>{const t={BOM_CODE:a.value.bomCode,BOM_VER:a.value.bomVer};try{const e=await u.post("http://localhost:3000/BOM_detailSelect",t);h.value=e.data.map(o=>({자재코드:o.MAT_CODE,자재명:o.MAT_NAME,자재유형:o.MAT_TYPE,소요수량:o.QTY,단위:o.UNIT}))}catch(e){console.error("자재 목록을 불러오는 중 오류가 발생했습니다:",e),r.error("자재 목록을 불러올 수 없습니다.",{position:"top-right",duration:1e3})}};le(()=>{F(),H()});const w=t=>{console.log(t.value),console.log(v.value)},_=s(""),$=async()=>{const t={PRD_NAME:_.value};try{const e=await u.post("http://localhost:3000/bomSearch",t);v.value=e.data.map(o=>({제품명:o.PRD_NAME,제품코드:o.PRD_CODE,제품유형:o.PRD_TYPE,작성자:o.PRD_WRITER,등록일:o.PRD_DATE.substring(0,10)})),console.log("검색 키워드:",_.value),console.log(v.value),D.value=[],h.value=[],r.success("검색이 완료되었습니다.",{position:"top-right",duration:1e3})}catch(e){console.error("검색 중 오류가 발생했습니다:",e),r.error("검색에 실패했습니다.",{position:"top-right",duration:1e3})}},W=()=>{a.value={writer:"",addDate:""},D.value=[],h.value=[],r.info("폼이 초기화되었습니다.",{position:"top-right",duration:1e3})},O=s(null),V=s(null),L=async t=>{try{const e=await u.post("http://localhost:3000/BOMbomSelect",t);D.value=e.data.map(o=>({BOM코드:o.BOM_CODE,제품명:o.PRD_NAME,BOM버젼:o.BOM_VER,작성자:o.BOM_WRITER,사용유무:o.USE_YN,등록일:o.BOM_RDATE.substring(0,10)}))}catch(e){console.error("BOM 목록을 불러오는 중 오류가 발생했습니다:",e),r.error("BOM 목록을 불러올 수 없습니다.",{position:"top-right",duration:1e3})}},q=async t=>{var o;a.value.prdName=t.data.제품명;const e={PRD_CODE:t.data.제품코드};try{const d=await u.post("http://localhost:3000/BOMbomSelect",e);D.value=d.data.map(c=>({BOM코드:c.BOM_CODE,제품명:c.PRD_NAME,BOM버젼:c.BOM_VER,작성자:c.BOM_WRITER,사용유무:c.USE_YN,등록일:c.BOM_RDATE.substring(0,10)})),O.value=t.data,V.value=(o=d.data[0])==null?void 0:o.BOM_VER}catch(d){console.error("BOM 목록을 불러오는 중 오류가 발생했습니다:",d),r.error("BOM 목록을 불러올 수 없습니다.",{position:"top-right",duration:1e3})}},j=async()=>{if(!a.value.prdName){r.error("제품을 선택해주세요.",{position:"top-right",duration:1e3});return}console.log(O.value);const t={PRD_CODE:O.value.제품코드,BOM_WRITER:"김태완",BOM_VER:V.value};try{const e=await u.post("http://localhost:3000/BOMinsert",t);console.log(e);const o={PRD_CODE:O.value.제품코드};await L(o),r.success("BOM이 성공적으로 추가되었습니다!",{position:"top-right",duration:1e3})}catch(e){console.error("BOM 추가 중 오류가 발생했습니다:",e),r.error("BOM 추가에 실패했습니다.",{position:"top-right",duration:1e3})}},z=async t=>{a.value.bomCode=t.data.BOM코드,a.value.bomVer=t.data.BOM버젼,a.value.writer=t.data.작성자,a.value.addDate=t.data.등록일,await b()},B=s(null),G=t=>{B.value=t.api},Q=async()=>{const t=B.value.getSelectedRows();if(!t.length){r.warning("수정할 자재를 선택해주세요.",{position:"top-right",duration:1e3});return}const e=t.map(d=>d.자재코드),o=t.map(d=>d.소요수량);try{await u.post("http://localhost:3000/bomMatUpdate",{bomCode:a.value.bomCode,matCodes:e,qtys:o}),r.success("저장이 완료되었습니다.",{position:"top-right",duration:1e3}),await b()}catch(d){console.error("저장 중 오류가 발생했습니다:",d),r.error("저장에 실패했습니다.",{position:"top-right",duration:1e3})}},Z=async()=>{const t=B.value.getSelectedRows();if(t.length===0){r.warning("삭제할 자재를 선택하세요.");return}const e={BOM_CODE:a.value.bomCode,MAT_CODE:t[0].자재코드};console.log(e);try{await u.post("http://localhost:3000/bomDelete",e),r.success("삭제가 완료되었습니다.",{position:"top-right",duration:1e3}),await b()}catch(o){console.error("삭제 중 오류가 발생했습니다:",o),r.error("삭제에 실패했습니다.",{position:"top-right",duration:1e3})}},E=s(null),x=s(""),T=s([]),A=s([]),K=[{field:"자재코드",headerName:"자재코드",flex:1},{field:"자재명",headerName:"자재명",flex:1},{field:"자재유형",headerName:"자재유형",flex:1},{field:"규격",headerName:"규격",flex:1,editable:!0},{field:"단위",headerName:"단위",flex:1,editable:!0}],N=s([]),H=async()=>{try{const t=await u.get("http://localhost:3000/BOMmodalSelect");N.value=t.data.map(e=>({자재코드:e.MAT_CODE,자재명:e.MAT_NAME,자재유형:e.MAT_TYPE,규격:e.MAT_SIZE,단위:e.MAT_UNIT}))}catch(t){console.error("모달 자재 목록을 불러오는 중 오류가 발생했습니다:",t),r.error("자재 목록을 불러올 수 없습니다.",{position:"top-right",duration:1e3})}},J=async(t,e,o)=>{if(!a.value.bomCode){r.warning("BOM이 선택되지 않았습니다.",{position:"top-right",duration:1e3});return}x.value=t,T.value=e,A.value=o,E.value&&E.value.open()},X=async t=>{const e={BOM_CODE:a.value.bomCode,MAT_CODE:t.자재코드,MAT_NAME:t.자재명,MAT_TYPE:t.자재유형,MAT_SIZE:t.규격,UNIT:t.단위,BOM_VER:a.value.bomVer};try{const o=await u.post("http://localhost:3000/BOMmodalConfirm",e);console.log(o),r.success("자재가 성공적으로 추가되었습니다!",{position:"top-right",duration:1e3}),await b()}catch(o){console.error("자재 추가 중 오류가 발생했습니다:",o),r.error("자재 추가에 실패했습니다.",{position:"top-right",duration:1e3})}};return(t,e)=>(re(),ae(ne,null,[l(ee,{title:U.value.title,breadcrumbs:Y.value},null,8,["title","breadcrumbs"]),l(oe,{title:"제품 목록"},{default:n(()=>[i("div",ce,[l(m,{label:"제품명 검색",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),"hide-details":"",class:"mr-2",style:{"max-width":"280px"}},null,8,["modelValue"]),l(f,{color:"darkText",onClick:$},{default:n(()=>e[7]||(e[7]=[p("검색")])),_:1})]),i("div",me,[i("div",fe,[l(M(y),{rowData:v.value,columnDefs:S.value,theme:M(C),style:{height:"200px",width:"100%"},onCellValueChanged:w,onRowClicked:q},null,8,["rowData","columnDefs","theme"]),e[11]||(e[11]=i("br",null,null,-1)),e[12]||(e[12]=i("br",null,null,-1)),i("div",pe,[e[10]||(e[10]=i("h5",{class:"mb-0 mr-3"},"BOM목록",-1)),l(m,{label:"제품명",modelValue:a.value.prdName,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.prdName=o),"hide-details":"",readonly:"true",style:{"max-width":"150px"}},null,8,["modelValue"]),l(R,{justify:"end"},{default:n(()=>[l(f,{color:"error",class:"mr-3",onClick:W},{default:n(()=>e[8]||(e[8]=[p("초기화")])),_:1}),l(f,{color:"primary",class:"mr-6",onClick:j},{default:n(()=>e[9]||(e[9]=[p("추가")])),_:1})]),_:1})]),l(M(y),{rowData:D.value,columnDefs:k.value,theme:M(C),style:{height:"200px",width:"100%"},onCellValueChanged:w,onRowClicked:z},null,8,["rowData","columnDefs","theme"])]),i("div",Me,[i("div",ve,[l(R,{class:"mb-4"},{default:n(()=>[l(g,{cols:"6"},{default:n(()=>[l(m,{label:"BOM코드",modelValue:a.value.bomCode,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.bomCode=o),readonly:!0,dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(g,{cols:"6"},{default:n(()=>[l(m,{label:"BOM버젼",modelValue:a.value.bomVer,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.bomVer=o),readonly:!0,dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(g,{cols:"6"},{default:n(()=>[l(m,{label:"작성자",modelValue:a.value.writer,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.writer=o),readonly:!0,outlined:""},null,8,["modelValue"])]),_:1}),l(g,{cols:"6"},{default:n(()=>[l(m,{label:"등록일자",modelValue:a.value.addDate,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.addDate=o),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),e[16]||(e[16]=i("br",null,null,-1)),e[17]||(e[17]=i("h5",{class:"mb-0 mr-3"},"자재목록",-1)),i("div",De,[l(R,{justify:"end"},{default:n(()=>[l(f,{color:"warning",class:"mr-4",onClick:e[6]||(e[6]=o=>J("자재 조회",N.value,K)),style:{"margin-bottom":"2rem"}},{default:n(()=>e[13]||(e[13]=[p("자재 조회 ")])),_:1}),l(f,{color:"primary",class:"mr-3",onClick:Q},{default:n(()=>e[14]||(e[14]=[p("저장")])),_:1}),l(f,{color:"error",class:"mr-4",onClick:Z},{default:n(()=>e[15]||(e[15]=[p("삭제")])),_:1})]),_:1}),l(ie,{ref_key:"modalRef",ref:E,title:x.value,rowData:T.value,colDefs:A.value,onConfirm:X},null,8,["title","rowData","colDefs"]),l(M(y),{rowData:h.value,columnDefs:I.value,theme:M(C),style:{height:"200px",width:"100%"},onCellValueChanged:w,rowSelection:"multiple",onGridReady:G,enableCellChangeFlash:"true"},null,8,["rowData","columnDefs","theme"])])])])]),_:1})],64))}},Ee=ue(he,[["__scopeId","data-v-c9f66e55"]]);export{Ee as default};
