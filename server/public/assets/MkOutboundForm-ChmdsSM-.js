import{_ as q,a as G}from"./UiParentCard.vue_vue_type_script_setup_true_lang-BW8k9qJX.js";import{B as H}from"./main-CfRLyuEJ.js";import{O as s,_ as K,$ as m,a8 as J,P as X,q as Z,o as _,a as t,w as n,V,b as u,c as w,a0 as i,d as ee,a2 as le,f as v,e as E,A as T,a1 as ae,F as te,a9 as oe}from"./index-BkOgXO0r.js";import{_ as k}from"./NewModal-C5NqQFOW.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={__name:"MkOutboundForm",setup(re){const A=ae,h=s([]);K(()=>{Q(),I()});const O=s(0),R=s(0),I=async()=>{try{const a=await m.get("http://localhost:3000/wrNameSelect");h.value=a.data.map(e=>e.WR_NAME)}catch(a){console.error("공통코드 데이터를 불러오는 데 실패했습니다:",a)}},f=s([]),M=s([{headerCheckboxSelection:!0,checkboxSelection:!0,width:50},{field:"제품코드",flex:1},{field:"제품명",flex:1},{field:"제품유형",flex:1},{field:"출하수량",editable:!0,flex:1},{field:"입고일자",flex:1},{field:"LOT번호",flex:1}]),l=J({order:"",customer:"",dueDate:"",shipDate:"",writer:"",wrName:"",cusId:""}),c=s(null),x=s(""),P=s([]),S=s([]),C=[{field:"주문서번호",headerName:"주문서번호",flex:1},{field:"주문일자",headerName:"주문일자",flex:1},{field:"거래처",headerName:"거래처",flex:1},{field:"제품명",headerName:"제품명",flex:1},{field:"주문수량",headerName:"주문수량",flex:1},{field:"납기일자",headerName:"납기일자",flex:1}],D=s([]),Q=async()=>{const a=await m.get("http://localhost:3000/shipModalSelect");D.value=a.data.map(e=>({주문서번호:e.REQ_ID,주문일자:e.REQ_DATE,거래처:e.CUS_ID,제품명:e.PRD_NAME,주문수량:e.REQ_QTY,납기일자:e.REQ_DDAY?e.REQ_DDAY.substring(0,10):null})),console.log(a)},L=async(a,e,o)=>{x.value=a,P.value=e,S.value=o,c.value&&c.value.open()},y=s(null),b=s(""),p=s([]),g=[{field:"LOT번호",headerName:"LOT번호",flex:1},{field:"제품코드",headerName:"제품코드",flex:1},{field:"제품명",headerName:"제품명",flex:1},{field:"제품유형",headerName:"제품유형",flex:1},{field:"재고수량",headerName:"재고수량",flex:1},{field:"입고일자",headerName:"입고일자",flex:1}],U=async a=>{var r;if(!l.order){alert("주문서를 선택해주세요");return}console.log("hi");const e={REQ_ID:l.order},o=await m.post("http://localhost:3000/shipPrdSelect",e);p.value=o.data.map(d=>({LOT번호:d.PRD_LOT,제품코드:d.PRD_CODE,제품명:d.PRD_NAME,제품유형:d.PRD_TYPE,재고수량:d.RECEIVED_QTY,입고일자:d.RECEIVED_DATE?d.RECEIVED_DATE.substring(0,10):null})),console.log(o),b.value=a,R.value++,await oe(),(r=y.value)==null||r.open()};function B(a){a&&(l.order=a.주문서번호||"",l.customer=a.거래처||"",l.dueDate=a.납기일자||"",l.cusId=a.거래처코드)}function F(a){Array.isArray(a)||(a=[a]),a.forEach(e=>{f.value.unshift({제품명:e.제품명||"",제품코드:e.제품코드||"",제품유형:e.제품유형||"",출하수량:e.재고수량||"",입고일자:e.입고일자||"",LOT번호:e.LOT번호})})}function Y(){l.supplier="",l.orderDate="",l.dueDate="",l.manager="",f.value=[]}const N=s(null),$=a=>{N.value=a.api};async function z(){if(!l.order){alert("주문서가 조회되지 않았습니다.");return}const a=N.value.getSelectedRows();if(a.length===0){alert("입고할 제품을 선택하세요");return}console.log(a);const e=a.map(r=>({REQ_ID:l.order,CUS_ID:l.customer,PRD_LOT:r.LOT번호,SHIP_ORDER_DATE:l.shipDate,SHIP_WRITER:l.writer,WR_NAME:l.wrName,PRD_CODE:r.제품코드,PRD_NAME:r.제품명,QTY:r.출하수량,D_DAY:l.dueDate})),o=await m.post("http://localhost:3000/shipInsert",e);console.log(o),alert("등록완료")}const W=s({title:"출하지시서 등록"}),j=X([{title:"제품 입출고",disabled:!0,href:"#"},{title:"출하지시서 등록",disabled:!1,href:"#"}]);return(a,e)=>(_(),Z(te,null,[t(q,{title:W.value.title,breadcrumbs:j.value},null,8,["title","breadcrumbs"]),t(G,{title:"출하지시서 등록"},{default:n(()=>[t(V,{class:"mb-4"},{default:n(()=>[t(u,{cols:"6"},{default:n(()=>[t(i,{label:"주문서번호",modelValue:l.order,"onUpdate:modelValue":e[1]||(e[1]=o=>l.order=o),dense:"",outlined:"",readonly:""},{"append-inner":n(()=>[ee("i",{class:"fa-solid fa-magnifying-glass",style:{cursor:"pointer","font-size":"large","margin-right":"0.5rem"},onClick:e[0]||(e[0]=o=>L("주문서 조회",D.value,C))})]),_:1},8,["modelValue"]),(_(),w(k,{ref_key:"modalRef",ref:c,key:O.value,title:x.value,rowData:D.value,colDefs:C,onConfirm:B},null,8,["title","rowData"]))]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(i,{label:"거래처",modelValue:l.customer,"onUpdate:modelValue":e[2]||(e[2]=o=>l.customer=o),outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(i,{label:"납기일자",modelValue:l.dueDate,"onUpdate:modelValue":e[3]||(e[3]=o=>l.dueDate=o),readonly:"true",type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(i,{label:"출하지시일자",modelValue:l.shipDate,"onUpdate:modelValue":e[4]||(e[4]=o=>l.shipDate=o),type:"date",max:`${l.dueDate}`,dense:"",outlined:""},null,8,["modelValue","max"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(i,{label:"작성자",modelValue:l.writer,"onUpdate:modelValue":e[5]||(e[5]=o=>l.writer=o),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(le,{label:"창고명",modelValue:l.wrName,"onUpdate:modelValue":e[6]||(e[6]=o=>l.wrName=o),items:h.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),t(V,{justify:"end"},{default:n(()=>[t(v,{color:"warning",class:"mr-3",onClick:e[7]||(e[7]=o=>U("입고 제품 조회",p.value,g))},{default:n(()=>e[8]||(e[8]=[E("입고 조회")])),_:1}),(_(),w(k,{ref_key:"modalRef1",ref:y,key:R.value,title:b.value,rowData:p.value,colDefs:g,onConfirm:F},null,8,["title","rowData"]))]),_:1})]),_:1}),t(T(H),{rowData:f.value,columnDefs:M.value,theme:T(A),style:{height:"200px",width:"100%"},onCellValueChanged:a.onCellValueChanged,onGridReady:$,rowSelection:"multiple"},null,8,["rowData","columnDefs","theme","onCellValueChanged"]),t(V,{justify:"end",class:"button"},{default:n(()=>[t(v,{color:"error",class:"mr-2",onClick:Y},{default:n(()=>e[9]||(e[9]=[E("초기화")])),_:1}),t(v,{color:"primary",onClick:z},{default:n(()=>e[10]||(e[10]=[E("등록")])),_:1})]),_:1})]),_:1})],64))}},ce=se(ne,[["__scopeId","data-v-ff154b26"]]);export{ce as default};
