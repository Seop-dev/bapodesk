import{_ as j,a as q}from"./UiParentCard.vue_vue_type_script_setup_true_lang-BW8k9qJX.js";import{O as u,P as Q,_ as J,$ as m,q as W,o as X,a as t,w as s,d as n,a0 as i,f as p,e as c,V as M,A as b,a1 as Y,b as r,a2 as Z,a3 as K,a4 as y,F as ee}from"./index-BkOgXO0r.js";import{B as le}from"./main-CfRLyuEJ.js";import{_ as ae}from"./NewModal-C5NqQFOW.js";import{d as te}from"./index-BqhsvV9-.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"d-flex align-center mb-4"},de={class:"main-container"},ue={class:"list-container"},ne={class:"form-wrapper"},ie={class:"add"},re={class:"radioDiv"},me={__name:"MasterEmp",setup(fe){const v=te.useToast(),A=u([]),R=u({title:"사원 관리"}),U=Q([{title:"기준정보",disabled:!0,href:"#"},{title:"사원 관리",disabled:!1,href:"#"}]),x=Y,l=u({empNo:"",phone:"",empName:"",hireDate:"",auth:"",dept:"",addr:"",status:"",endDate:""});J(()=>{f(),H(),F()});const E=u([]),C=u([{checkboxSelection:!0,width:50},{field:"사원번호",width:150},{field:"사원명",width:140},{field:"부서",width:130},{field:"직급",width:130},{field:"재직상태",width:130},{field:"연락처",width:150},{field:"이메일",width:150},{field:"주소",width:200},{field:"입사일자",width:110},{field:"퇴사일자",width:110}]),f=async()=>{const a=await m.get("http://localhost:3000/masterEmp");E.value=a.data.map(e=>({사원번호:e.EMP_NO,사원명:e.EMP_NAME,입사일자:e.EMP_HDATE?e.EMP_HDATE.substring(0,10):null,주소:e.ADDR,연락처:e.PHONE,이메일:e.EMAIL,부서:e.DEPT_NAME,직급:e.AUTH,퇴사일자:e.EMP_EDATE?e.EMP_EDATE.substring(0,10):null,재직상태:e.EMP_STATUS}))},w=u([]),H=async()=>{try{const a=await m.get("http://localhost:3000/commonAuth");w.value=a.data.map(e=>e.code_name)}catch(a){console.error("공통코드 데이터를 불러오는 데 실패했습니다:",a)}},k=async a=>{if(console.log(a),!a.value){v.error("사원이 입력되지 않았습니다");return}const e={EMP_NAME:`%${a}%`},o=await m.post("http://localhost:3000/masterEmpName",e);E.value=o.data.map(d=>({사원번호:d.EMP_NO,사원명:d.EMP_NAME,입사일자:d.EMP_HDATE?d.EMP_HDATE.substring(0,10):null,주소:d.ADDR,연락처:d.PHONE,이메일:d.EMAIL,부서:d.DEPT_NAME,직급:d.AUTH,퇴사일자:d.EMP_EDATE?d.EMP_EDATE.substring(0,10):null,재직상태:d.EMP_STATUS}))},S=async()=>{var a,e,o,d;if(l.value.empNo){const V={EMP_NAME:l.value.empName,PHONE:l.value.phone,EMAIL:l.value.email,DEPT_NAME:l.value.dept,AUTH:l.value.auth,ADDR:l.value.addr,EMP_STATUS:l.value.status,EMP_HDATE:((a=l.value.hireDate)==null?void 0:a.trim())||null,EMP_EDATE:((e=l.value.endDate)==null?void 0:e.trim())||null,EMP_NO:l.value.empNo},h=await m.put("http://localhost:3000/masterEmpUpdate",V);console.log(h.config.data),v.success(`${l.value.empName}의 정보가 수정되었습니다`,{position:"top-right",duration:1e3}),f()}else{if(l.value.endDate){v.error("퇴직이 선택되어있습니다.");return}const V={EMP_NAME:l.value.empName,PHONE:l.value.phone,EMAIL:l.value.email,DEPT_NAME:l.value.dept,AUTH:l.value.auth,ADDR:l.value.addr,EMP_STATUS:l.value.status,EMP_HDATE:((o=l.value.hireDate)==null?void 0:o.trim())||null,EMP_EDATE:((d=l.value.endDate)==null?void 0:d.trim())||null},h=await m.post("http://localhost:3000/masterEmpInsert",V);console.log(h.config.data),f()}};let D=null;const O=a=>{D=a.api},$=async()=>{if(!D)return;const a=D.getSelectedRows();if(a.length===0){alert("삭제할 항목을 선택하세요");return}const e={empNo:a[0].사원번호};console.log(e);const o=await m.delete("http://localhost:3000/masterEmpDelete",{data:e});console.log(o),f()},B=()=>{l.value={empName:"",hireDate:"",empNo:"",email:"",phone:"",auth:"",dept:"",addr:"",status:"재직"}},I=a=>{console.log(a.data),l.value.empNo=a.data.사원번호,l.value.empName=a.data.사원명,l.value.hireDate=a.data.입사일자,l.value.addr=a.data.주소,l.value.dept=a.data.부서,l.value.auth=a.data.직급,l.value.email=a.data.이메일,l.value.status=a.data.재직상태,l.value.phone=a.data.연락처,l.value.endDate=a.data.퇴사일자},_=u(null),N=u(""),P=u([]),T=u([]),L=[{field:"그룹코드",headerName:"그룹코드",flex:1},{field:"부서명",headerName:"부서명",flex:1}],g=u([]),F=async()=>{const a=await m.get("http://localhost:3000/commonDept");g.value=a.data.map(e=>({그룹코드:e.group_code,부서명:e.code_name})),console.log(a)},z=async(a,e,o)=>{N.value=a,P.value=e,T.value=o,_.value&&_.value.open()},G=async a=>{l.value.size=a.규격};return(a,e)=>(X(),W(ee,null,[t(j,{title:R.value.title,breadcrumbs:U.value},null,8,["title","breadcrumbs"]),t(q,{title:"사원 목록"},{default:s(()=>[n("div",se,[t(i,{label:"사원 검색",modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=o=>A.value=o),"hide-details":"",class:"mr-2",style:{"max-width":"280px"}},null,8,["modelValue"]),t(p,{color:"darkText",onClick:k},{default:s(()=>e[12]||(e[12]=[c("검색")])),_:1}),t(M,{justify:"end",class:"mr-3"},{default:s(()=>[t(p,{color:"error",class:"mr-1",onClick:$},{default:s(()=>e[13]||(e[13]=[c("삭제")])),_:1})]),_:1})]),n("div",de,[n("div",ue,[t(b(le),{rowData:E.value,columnDefs:C.value,theme:b(x),style:{height:"500px",width:"100%"},rowSelection:"single",onRowClicked:I,onGridReady:O},null,8,["rowData","columnDefs","theme"])]),n("div",ne,[n("div",ie,[t(M,{class:"mb-4"},{default:s(()=>[t(r,{cols:"6"},{default:s(()=>[t(i,{label:"사원번호",modelValue:l.value.empNo,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.empNo=o),readonly:"true",outlined:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"6"},{default:s(()=>[t(i,{label:"사원명",modelValue:l.value.empName,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.empName=o),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"6"},{default:s(()=>[t(i,{label:"연락처",modelValue:l.value.phone,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.phone=o),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"6"},{default:s(()=>[t(i,{label:"이메일",modelValue:l.value.email,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.email=o),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"6"},{default:s(()=>[t(i,{label:"부서명",modelValue:l.value.dept,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.dept=o),placeholder:"부서명",dense:"",outlined:"",readonly:""},{"append-inner":s(()=>[n("i",{class:"fa-solid fa-magnifying-glass",style:{cursor:"pointer","font-size":"large","margin-right":"0.5rem"},onClick:e[5]||(e[5]=o=>z("부서 조회",g.value,L))})]),_:1},8,["modelValue"]),t(ae,{ref_key:"modalRef",ref:_,title:N.value,rowData:P.value,colDefs:T.value,onConfirm:G},null,8,["title","rowData","colDefs"])]),_:1}),t(r,{cols:"6"},{default:s(()=>[t(Z,{label:"직급",modelValue:l.value.auth,"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.auth=o),items:w.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),t(r,{cols:"12"},{default:s(()=>[t(i,{label:"주소",modelValue:l.value.addr,"onUpdate:modelValue":e[8]||(e[8]=o=>l.value.addr=o),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),n("div",re,[e[14]||(e[14]=n("span",{class:"mr-4"},"재직 상태 :",-1)),t(K,{modelValue:l.value.status,"onUpdate:modelValue":e[9]||(e[9]=o=>l.value.status=o),inline:"","hide-details":""},{default:s(()=>[t(y,{label:"재직",value:"재직"}),t(y,{label:"퇴직",value:"퇴직"})]),_:1},8,["modelValue"])]),t(r,{cols:"4"},{default:s(()=>[t(i,{label:"입사일자",modelValue:l.value.hireDate,"onUpdate:modelValue":e[10]||(e[10]=o=>l.value.hireDate=o),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"4"},{default:s(()=>[t(i,{label:"퇴사일자",modelValue:l.value.endDate,"onUpdate:modelValue":e[11]||(e[11]=o=>l.value.endDate=o),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(M,{justify:"center"},{default:s(()=>[t(p,{color:"error",class:"mr-3",onClick:B},{default:s(()=>e[15]||(e[15]=[c("초기화")])),_:1}),t(p,{color:"primary",class:"mr-6",onClick:S},{default:s(()=>e[16]||(e[16]=[c("저장")])),_:1})]),_:1})]),_:1})]),e[17]||(e[17]=n("br",null,null,-1))])])]),_:1})],64))}},Ve=oe(me,[["__scopeId","data-v-7de4332c"]]);export{Ve as default};
