import{_ as oe,a as de}from"./UiParentCard.vue_vue_type_script_setup_true_lang-BW8k9qJX.js";import{B as se}from"./main-CfRLyuEJ.js";import{O as V,P as _,aa as ne,y as D,at as ie,q as L,o as S,a as t,w as o,d,c as me,k as E,V as G,b as p,a0 as f,a2 as pe,f as H,e as n,aX as ce,t as m,S as fe,T as ye,j as x,W as I,A as j,F as ve}from"./index-BkOgXO0r.js";import{_ as Qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ne={class:"search-card"},be={class:"search-actions"},Ae={key:0,class:"mini-summary"},Ve={class:"summary-chips"},ge={class:"totals"},we={__name:"PerformanceCheck",setup(Te){const X=V({title:"생산 실적 조회"}),J=_([{title:"생산",disabled:!0,href:"#"},{title:"생산 실적 조회",disabled:!1,href:"#"}]),s=V({issueNumber:"",productName:"",productType:"",startAt:"",endAt:""});function K(){s.value={issueNumber:"",productName:"",productType:"",startAt:"",endAt:""},c.value=null,b.value=[],F(),Q()}function g(l){return String(l).padStart(2,"0")}function r(l,e,a,y,N){return`${l}-${g(e)}-${g(a)}T${g(y)}:${g(N)}`}const M=["재단","가공","연마","도장","조립"],h=_([{issueNumber:"WO-20250811-2856",productCode:"P001",productName:"블랙 데스크",productType:"완제품",items:[{process:"재단",worker:"최윤수",startAt:r(2025,8,11,9,10),endAt:r(2025,8,11,10,20),orderQty:50,inputQty:50,defectQty:0,outputQty:50},{process:"가공",worker:"김성수",startAt:r(2025,8,11,10,30),endAt:r(2025,8,11,12,0),orderQty:50,inputQty:50,defectQty:2,outputQty:48},{process:"연마",worker:"정경준",startAt:r(2025,8,11,13,10),endAt:r(2025,8,11,14,0),orderQty:50,inputQty:48,defectQty:1,outputQty:47},{process:"도장",worker:"김태완",startAt:r(2025,8,11,14,20),endAt:r(2025,8,11,16,10),orderQty:50,inputQty:47,defectQty:1,outputQty:46},{process:"조립",worker:"이동현",startAt:r(2025,8,11,16,30),endAt:r(2025,8,11,17,10),orderQty:50,inputQty:46,defectQty:0,outputQty:46}]},{issueNumber:"WO-20250705-4112",productCode:"P001",productName:"블랙 데스크",productType:"완제품",items:[{process:"재단",worker:"최윤수",startAt:r(2025,7,5,9,0),endAt:r(2025,7,5,10,0),orderQty:120,inputQty:120,defectQty:0,outputQty:120},{process:"가공",worker:"김성수",startAt:r(2025,7,5,10,10),endAt:r(2025,7,5,12,30),orderQty:120,inputQty:120,defectQty:5,outputQty:115},{process:"연마",worker:"정경준",startAt:r(2025,7,5,13,0),endAt:r(2025,7,5,13,50),orderQty:120,inputQty:115,defectQty:1,outputQty:114},{process:"도장",worker:"김태완",startAt:r(2025,7,5,14,10),endAt:r(2025,7,5,16,30),orderQty:120,inputQty:114,defectQty:2,outputQty:112},{process:"조립",worker:"이동현",startAt:r(2025,7,5,16,40),endAt:r(2025,7,5,17,20),orderQty:120,inputQty:112,defectQty:0,outputQty:112}]},{issueNumber:"WO-20250621-1023",productCode:"P002",productName:"화이트 데스크",productType:"반제품",items:[{process:"재단",worker:"최은수",startAt:r(2025,6,21,9,10),endAt:r(2025,6,21,10,0),orderQty:200,inputQty:200,defectQty:0,outputQty:200},{process:"가공",worker:"김성수",startAt:r(2025,6,21,10,10),endAt:r(2025,6,21,12,40),orderQty:200,inputQty:200,defectQty:4,outputQty:196},{process:"연마",worker:"정경준",startAt:r(2025,6,21,13,20),endAt:r(2025,6,21,14,10),orderQty:200,inputQty:196,defectQty:2,outputQty:194},{process:"도장",worker:"김태완",startAt:r(2025,6,21,14,30),endAt:r(2025,6,21,15,50),orderQty:200,inputQty:194,defectQty:1,outputQty:193}]}]),c=V(null),b=V([]),u=V({issueNumber:"",orderDate:"",contact:"",productCode:"",dueDate:"",targetQty:0,productName:""});function F(){u.value={issueNumber:"",orderDate:"",contact:"",productCode:"",dueDate:"",targetQty:0,productName:""}}function P(l){const e=s.value.startAt?new Date(s.value.startAt).getTime():null,a=s.value.endAt?new Date(s.value.endAt).getTime():null,y=new Date(l).getTime();return!(e&&y<e||a&&y>a)}const Y=ne();function Z(){var z,B,O,q,R,W;let e=Y.findPerformance(s.value);if(!e){const i=s.value.issueNumber.trim(),v=s.value.productName.trim(),k=s.value.productType;i&&(e=h.value.find(T=>T.issueNumber.includes(i))),!e&&(v||k)&&(e=h.value.find(T=>(!v||T.productName.includes(v))&&(!k||T.productType===k)))}if(!e){c.value=null,b.value=[],F(),alert("검색결과가 없습니다."),Q();return}c.value=e;const y=[...e.items].sort((i,v)=>M.indexOf(i.process)-M.indexOf(v.process)).filter(i=>!s.value.startAt&&!s.value.endAt||P(i.startAt)||P(i.endAt));b.value=y.map((i,v)=>({seq:v+1,...i,startText:(i.startAt||"").replace("T"," "),endText:(i.endAt||"").replace("T"," "),durationMin:ae(i.startAt,i.endAt)}));const N=((B=(z=e.items)==null?void 0:z[0])==null?void 0:B.startAt)??"",C=((q=(O=e.items)==null?void 0:O[e.items.length-1])==null?void 0:q.endAt)??"";u.value.issueNumber=e.issueNumber,u.value.orderDate=(N||"").split("T")[0]||"",u.value.contact="홍길동",u.value.productCode=e.productCode,u.value.dueDate=(C||"").split("T")[0]||"",u.value.targetQty=((W=(R=e.items)==null?void 0:R[0])==null?void 0:W.orderQty)??0,u.value.productName=e.productName,Q()}function ee(l){return l==="반제품"?["재단","가공","연마","도장"]:["재단","가공","연마","도장","조립"]}const U=D(()=>{const l=c.value;if(!l)return 0;const a=ee(l.productType).map(y=>{var N;return((N=l.items.find(C=>C.process===y))==null?void 0:N.outputQty)??0});return a.length?Math.max(0,Math.min(...a)):0});function te(){}const A=D(()=>{const l={orderQty:0,inputQty:0,defectQty:0,outputQty:0,durationMin:0};return b.value.forEach(e=>{l.orderQty+=e.orderQty||0,l.inputQty+=e.inputQty||0,l.defectQty+=e.defectQty||0,l.outputQty+=e.outputQty||0,l.durationMin+=e.durationMin||0}),l}),le=D(()=>$(A.value.durationMin));function ae(l,e){return Math.max(0,Math.round((new Date(e)-new Date(l))/6e4))}function $(l){const e=Math.floor(l/60),a=l%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}`}let w;function re(l){w=l.api,Q()}function Q(){w==null||w.sizeColumnsToFit()}const ue=ie([{headerName:"공정명",field:"process",width:110,cellClass:"cell-ellipsis"},{headerName:"작업자",field:"worker",width:100,cellClass:"cell-ellipsis"},{headerName:"시작일시",field:"startText",minWidth:160,flex:1,cellClass:"cell-ellipsis"},{headerName:"종료일시",field:"endText",minWidth:160,flex:1,cellClass:"cell-ellipsis"},{headerName:"소요시간(시:분)",field:"durationMin",width:130,valueFormatter:l=>l.value==null?"":$(l.value),cellClass:"ag-right-aligned-cell"},{headerName:"지시량",field:"orderQty",width:100,cellClass:"ag-right-aligned-cell"},{headerName:"투입량",field:"inputQty",width:100,cellClass:"ag-right-aligned-cell"},{headerName:"불량량",field:"defectQty",width:100,cellClass:"ag-right-aligned-cell"},{headerName:"생산량",field:"outputQty",width:100,cellClass:"ag-right-aligned-cell"}]);return(l,e)=>(S(),L(ve,null,[t(oe,{title:X.value.title,breadcrumbs:J.value},null,8,["title","breadcrumbs"]),t(de,null,{default:o(()=>[d("div",Ne,[e[15]||(e[15]=d("h5",{class:"pane-title"},"생산실적조회",-1)),t(G,{class:"mt-2",dense:""},{default:o(()=>[t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"지시번호",modelValue:s.value.issueNumber,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.issueNumber=a),modelModifiers:{trim:!0},dense:"",outlined:"",placeholder:"예) WO-20250811-2856"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"제품명",modelValue:s.value.productName,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.productName=a),modelModifiers:{trim:!0},dense:"",outlined:"",placeholder:"예) 블랙 데스크"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(pe,{label:"제품유형",modelValue:s.value.productType,"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.productType=a),items:[{title:"전체",value:""},{title:"완제품",value:"완제품"},{title:"반제품",value:"반제품"}],dense:"",outlined:"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),d("div",be,[t(H,{variant:"flat",color:"error",onClick:K},{default:o(()=>e[10]||(e[10]=[n("초기화")])),_:1}),t(H,{class:"ml-2",color:"darkText",onClick:Z},{default:o(()=>e[11]||(e[11]=[n("검색")])),_:1})]),c.value?(S(),L("div",Ae,[t(ce,{type:"info",variant:"tonal",density:"compact"},{default:o(()=>[e[12]||(e[12]=n(" 지시번호: ")),d("b",null,m(c.value.issueNumber),1),e[13]||(e[13]=d("span",{class:"divider"},"|",-1)),n(" 제품명: "+m(c.value.productName)+" ",1),e[14]||(e[14]=d("span",{class:"divider"},"|",-1)),n(" 제품유형: "+m(c.value.productType),1)]),_:1})])):E("",!0)]),c.value?(S(),me(I,{key:0,class:"info-card mt-4",variant:"outlined"},{default:o(()=>[t(fe,{class:"py-2"},{default:o(()=>e[16]||(e[16]=[n("기본정보")])),_:1}),t(ye,null,{default:o(()=>[t(G,{class:"mb-2",dense:""},{default:o(()=>[t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"지시번호",modelValue:u.value.issueNumber,"onUpdate:modelValue":e[3]||(e[3]=a=>u.value.issueNumber=a),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"지시일자",modelValue:u.value.orderDate,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value.orderDate=a),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"작성자",modelValue:u.value.contact,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value.contact=a),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"제품코드",modelValue:u.value.productCode,"onUpdate:modelValue":e[6]||(e[6]=a=>u.value.productCode=a),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"납기일자",modelValue:u.value.dueDate,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value.dueDate=a),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"목표수량",modelValue:u.value.targetQty,"onUpdate:modelValue":e[8]||(e[8]=a=>u.value.targetQty=a),modelModifiers:{number:!0},type:"number",min:"0",step:"1",dense:"",outlined:"",onInput:te},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:o(()=>[t(f,{label:"제품명칭",modelValue:u.value.productName,"onUpdate:modelValue":e[9]||(e[9]=a=>u.value.productName=a),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),d("div",Ve,[t(x,{size:"small",variant:"tonal"},{default:o(()=>[n("목표 "+m((u.value.targetQty??0).toLocaleString()),1)]),_:1}),t(x,{size:"small",color:"primary",variant:"tonal"},{default:o(()=>[n("기생산 "+m(U.value.toLocaleString()),1)]),_:1}),t(x,{size:"small",color:"error",variant:"tonal"},{default:o(()=>[n(" 미생산 "+m(Math.max((u.value.targetQty||0)-U.value,0).toLocaleString()),1)]),_:1})])]),_:1})]),_:1})):E("",!0),e[22]||(e[22]=d("div",{class:"section-head mt-4"},[d("h5",{class:"pane-title"},"조회결과")],-1)),t(j(se),{class:"ag-theme-quartz ag-no-wrap",rowData:b.value,columnDefs:j(ue),pagination:!0,paginationPageSize:10,domLayout:"autoHeight",onGridReady:re,onFirstDataRendered:Q,onGridSizeChanged:Q},null,8,["rowData","columnDefs"]),t(I,{class:"mt-3 pa-3",variant:"outlined"},{default:o(()=>[d("div",ge,[d("div",null,[e[17]||(e[17]=n(" 소요시간 합계: ")),d("b",null,m(le.value),1)]),d("div",null,[e[18]||(e[18]=n(" 지시량 합계: ")),d("b",null,m(A.value.orderQty),1)]),d("div",null,[e[19]||(e[19]=n(" 투입량 합계: ")),d("b",null,m(A.value.inputQty),1)]),d("div",null,[e[20]||(e[20]=n(" 불량량 합계: ")),d("b",null,m(A.value.defectQty),1)]),d("div",null,[e[21]||(e[21]=n(" 생산량 합계: ")),d("b",null,m(A.value.outputQty),1)])])]),_:1})]),_:1})],64))}},xe=Qe(we,[["__scopeId","data-v-1693a0a4"]]);export{xe as default};
